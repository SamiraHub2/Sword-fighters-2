-- Load external library
loadstring(game:HttpGet("https://raw.githubusercontent.com/REDzHUB/LibraryV2/main/redzLib"))()

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local VirtualUser = game:GetService("VirtualUser")
local localPlayer = Players.LocalPlayer

-- Variables
local autoClick = false
local selectedMob = ""
local MobList = {}
local autoMobs = false
local autoQuest = false
local TpWorld = false
local TpWorld2 = false
local autoAfk = false

-- Functions
local function listMobs()
    MobList = {}
    for _, mob in ipairs(game.Workspace.Live.NPCs.Client:GetChildren()) do 
        if mob.Name ~= "" then
            table.insert(MobList, mob.Name)
        end
    end
end

local function click()
    spawn(function()
        while autoClick do
            wait()
            local success, err = pcall(function()
                ReplicatedStorage.Packages.Knit.Services.ClickService.RF.Click:InvokeServer()
            end)
            if not success then
                warn("Failed to invoke ClickService: " .. tostring(err))
            end
        end
    end)
end

local function farmAllMobs()
    while autoMobs do
        wait()
        local mobs = game.Workspace.Live.NPCs.Client:GetChildren()
        if mobs then
            for _, mob in ipairs(mobs) do
                if mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    local character = localPlayer.Character
                    if character and character:FindFirstChild("HumanoidRootPart") then
                        character.HumanoidRootPart.CFrame = mob.HumanoidRootPart.CFrame
                    else
                        warn("Local player character or HumanoidRootPart not found.")
                    end
                end
            end
        end
    end
end

local function completeQuests()
    while autoQuest do
        wait()
        for i = 1, 22 do
            local args = {
                [1] = "Area " .. i
            }
            ReplicatedStorage.Packages.Knit.Services.QuestService.RF.ActionQuest:InvokeServer(unpack(args))
        end
    end
end

local function antiAfk()
    local VirtualInputManager = game:GetService("VirtualInputManager")
    
    while autoAfk do
        VirtualInputManager:SendKeyEvent(true, "Space", false, game)
        wait(0.2)
        VirtualInputManager:SendKeyEvent(false, "Space", false, game)
        wait(300)
    end
end

-- GUI
MakeWindow({
    Hub = {
        Title = "Sword Fighters 2 | Dev | Script",
        Animation = "Sword Fighters 2 | Dev | Script"
    },
    Key = {
        KeySystem = false,
        Title = "Key System",
        Description = "",
        KeyLink = "",
        Keys = {"1234"},
        Notifi = {
            Notifications = true,
            CorrectKey = "Running the Script...",
            Incorrectkey = "The key is incorrect",
            CopyKeyLink = "Copied to Clipboard"
        }
    }
})

MinimizeButton({
    Image = "",
    Size = {75, 40},
    Color = Color3.fromRGB(10, 10, 10),
    Corner = true,
    Stroke = true,
    StrokeColor = Color3.fromRGB(255, 255, 255)
})

local Main = MakeTab({Name = "Main"})
local Quest = MakeTab({Name = "Quest From all the worlds"})
local Egg = MakeTab({Name = "Eggs From All Worlds"})
AddSection(Main, {"By Dev | Script | Tester"})

AddToggle(Main, {
    Name = "Auto Click",
    Default = false,
    Callback = function(value)
        autoClick = value
        if value then
            click()
            print("Auto Click enabled")
        else
            print("Auto Click disabled")
        end
    end
})

listMobs()

AddDropdown(Main, {
    Name = "Select Mob",
    Options = MobList,
    Default = "Select",
    Callback = function(value)
        selectedMob = value
        while selectedMob == value do
            wait()
            local selectedMobInstance = game.Workspace.Live.NPCs.Client:FindFirstChild(value)
            if selectedMobInstance and selectedMobInstance:FindFirstChild("Humanoid") and selectedMobInstance.Humanoid.Health > 0 then
                if localPlayer.Character then
                    localPlayer.Character:SetPrimaryPartCFrame(selectedMobInstance.HumanoidRootPart.CFrame)
                    local args = { [1] = selectedMobInstance }
                    local success, err = pcall(function()
                        ReplicatedStorage.Packages.Knit.Services.ClickService.RF.Click:InvokeServer(unpack(args))
                    end)
                    if not success then
                        warn("Failed to invoke ClickService: " .. tostring(err))
                    end
                else
                    warn("Local player character not found.")
                end
            else
                print("Selected mob is not valid or is dead.")
            end
        end
    end
})

AddToggle(Main, {
    Name = "Auto Farm All Mobs",
    Default = false,
    Callback = function(value)
        autoMobs = value
        if value then
            spawn(farmAllMobs)
        else
            print("Auto Farm All Mobs disabled")
        end
    end
})

AddToggle(Quest, {
    Name = "Auto Quest",
    Default = false,
    Callback = function(value)
        autoQuest = value
        if value then
            spawn(completeQuests)
        else
            print("Auto Quest disabled")
        end
    end
})

AddToggle(Main, {
    Name = "Anti AFK",
    Default = false,
    Callback = function(value)
        autoAfk = value
        if value then
            spawn(antiAfk)
        end
    end
})

AddToggle(Main, {
    Name = "Tp Penultimo mundo",
    Default = false,
    Callback = function(value)
        TpWorld = value
        if value then
            spawn(function()
                while TpWorld do
                    wait()
                    localPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(8767.36523, 161.006012, 6792.77881)
                end
            end)
        end
    end
})

AddToggle(Main, {
    Name = "Tp ultimo mundo (Novo)",
    Default = false,
    Callback = function(value)
        TpWorld2 = value
        if value then
            spawn(function()
                while TpWorld2 do
                    wait()
                    localPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-96.8715744, 196.465454, 5238.40088)
                end
            end)
        end
    end
})
