-- Load the library
loadstring(game:HttpGet("https://raw.githubusercontent.com/REDzHUB/LibraryV2/main/redzLib"))()

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local VirtualUser = game:GetService("VirtualUser")
local localPlayer = Players.LocalPlayer

-- Variables
local autoClick = false
local selectedMob = ""
local MobList = {}
local autoEgg22 = false
local autoEgg23 = false
local autoEgg24 = false
local autoMobs = false

-- Functions
local function List()
    MobList = {}
    for _, mob in ipairs(game.Workspace.Live.NPCs.Client:GetChildren()) do 
        if mob.Name ~= "" then
            table.insert(MobList, mob.Name)
        end
    end
end

local function Click()
    spawn(function()
        while autoClick do
            wait()
            local success, err = pcall(function()
                ReplicatedStorage.Packages.Knit.Services.ClickService.RF.Click:InvokeServer()
            end)
            if not success then
                warn("Failed to invoke ClickService: " .. tostring(err))
            end
        end
    end)
end

local function Egg22()
    while autoEgg22 do
        wait()
        local args = {
            [1] = {
                ["eggName"] = "Egg 22",
                ["auto"] = false,
                ["amount"] = 2
            }
        }
        game:GetService("ReplicatedStorage").Packages.Knit.Services.EggService.RF.BuyEgg:InvokeServer(unpack(args))
    end
end

local function Egg23()
    while autoEgg23 do
        wait()
        local args = {
            [1] = {
                ["eggName"] = "Egg 23",
                ["auto"] = false,
                ["amount"] = 2
            }
        }
        game:GetService("ReplicatedStorage").Packages.Knit.Services.EggService.RF.BuyEgg:InvokeServer(unpack(args))
    end
end

local function Egg24()
    while autoEgg24 do
        wait()
        local args = {
            [1] = {
                ["eggName"] = "Egg 24",
                ["auto"] = false,
                ["amount"] = 2
            }
        }
        game:GetService("ReplicatedStorage").Packages.Knit.Services.EggService.RF.BuyEgg:InvokeServer(unpack(args))
    end
end

local function AllMobs()
    while autoMobs do
        task.wait()
        local Mobs = game.Workspace.Live.NPCs.Client:GetChildren()
        if Mobs then
            for _, mob in ipairs(Mobs) do
                if mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    local character = localPlayer.Character
                    if character and character:FindFirstChild("HumanoidRootPart") then
                        local humanoidRootPart = character.HumanoidRootPart
                        humanoidRootPart.CFrame = mob.HumanoidRootPart.CFrame + Vector3.new(0, 0, 4)
                        VirtualUser:Button1Down(Vector2.new(1000, 1000), workspace.CurrentCamera.CFrame)
                        task.wait(0.1)
                        VirtualUser:Button1Up(Vector2.new(1000, 1000), workspace.CurrentCamera.CFrame)
                        ReplicatedStorage.Packages.Knit.Services.ClickService.RF.Click:InvokeServer()
                    else
                        warn("Local player character or HumanoidRootPart not found.")
                    end
                end
            end
        end
    end
end

-- GUI
MakeWindow({
    Hub = {
        Title = "Sword Fighters 2 | Dev | Script",
        Animation = "Sword Fighters 2 | Dev | Script"
    },
    Key = {
        KeySystem = false,
        Title = "Key System",
        Description = "",
        KeyLink = "",
        Keys = {"1234"},
        Notifi = {
            Notifications = true,
            CorrectKey = "Running the Script...",
            Incorrectkey = "The key is incorrect",
            CopyKeyLink = "Copied to Clipboard"
        }
    }
})

MinimizeButton({
    Image = "",
    Size = {75, 40},
    Color = Color3.fromRGB(10, 10, 10),
    Corner = true,
    Stroke = true,
    StrokeColor = Color3.fromRGB(255, 255, 255)
})

local Main = MakeTab({Name = "Main"})
local Egg = MakeTab({Name = "Eggs From All Worlds "})
local section01 = AddSection(Main, {"By Dev | Script | Tester"})

local ToggleAutoEgg22 = AddToggle(Egg, {
    Name = "Auto Egg 22",
    Default = false,
    Callback = function(value)
        autoEgg22 = value
        if value then
            spawn(Egg22)
        end
    end
})

local ToggleAutoEgg23 = AddToggle(Egg, {
    Name = "Auto Egg 23",
    Default = false,
    Callback = function(value)
        autoEgg23 = value
        if value then
            spawn(Egg23)
        end
    end
})

local ToggleAutoEgg24 = AddToggle(Egg, {
    Name = "Auto Egg 24",
    Default = false,
    Callback = function(value)
        autoEgg24 = value
        if value then
            spawn(Egg24)
        end
    end
})

local Toggleautoclick = AddToggle(Main, {
    Name = "Auto Click",
    Default = false,
    Callback = function(value)
        autoClick = value
        if value then
            Click()
            print("Auto Click enabled")
        else
            print("Auto Click disabled")
        end
    end
})

-- Function to reset the dropdown
local function ResetDropdown()
    Dropdown:SetValue("Select")  -- Set the default value of the dropdown
end

-- Button to reset the dropdown
local ResetButton = AddButton(Main, {
    Name = "Reset Dropdown",
    Callback = ResetDropdown
})

-- Populate MobList initially
List()

local Dropdown = AddDropdown(Main, {
    Name = "Select Mob",
    Options = MobList,
    Default = "Select",
    Callback = function(value)
        selectedMob = value
        while selectedMob == value do
            wait()
            local selectedMobInstance = game.Workspace.Live.NPCs.Client:FindFirstChild(value)
            if selectedMobInstance and selectedMobInstance:FindFirstChild("Humanoid") and selectedMobInstance.Humanoid.Health > 0 then
                if localPlayer.Character then
                    localPlayer.Character:SetPrimaryPartCFrame(selectedMobInstance.HumanoidRootPart.CFrame)
                    local args = {
                        [1] = selectedMobInstance
                    }
                    local success, err = pcall(function()
                        ReplicatedStorage.Packages.Knit.Services.ClickService.RF.Click:InvokeServer(unpack(args))
                    end)
                    if not success then
                        warn("Failed to invoke ClickService: " .. tostring(err))
                    end
                else
                    warn("Local player character not found.")
                end
            else
                print("Selected mob is not valid or is dead.")
            end
        end
    end
})

-- Ensure the GUI is updated with the current list of mobs
local function RefreshMobList()
    List()
    -- Update the dropdown options
    if Dropdown.SetOptions then
        Dropdown:SetOptions(MobList)
    end
end

-- Periodically update the mob list
spawn(function()
    while true do
        wait(30)  -- Adjust the interval as needed
        RefreshMobList()
    end
end)

local ToggleFarm = AddToggle(Main, {
    Name = "Auto Farm All Mobs",
    Default = false,
    Callback = function(value)
        autoMobs = value
        if value then
            spawn(AllMobs)
        else
            print("Auto Farm All Mobs disabled")
        end
    end
})
